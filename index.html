<!DOCTYPE html>
<html>
<head>
  <title>De Koen Quiz ðŸŽ„</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
  body {
  margin: 0;
  font-family: "Inter", sans-serif;
  background: linear-gradient(135deg, #fff0f0, #ffeaea); /* soft red/white gradient */
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  padding: 20px;
}

.quiz-card {
  background: white;
  padding: 35px 40px;
  border-radius: 20px;
  width: 420px;
  box-shadow: 0px 10px 40px rgba(255, 0, 0, 0.15); /* subtle red shadow */
  text-align: center;
  animation: fadeIn 0.4s ease;
}

h1 {
  margin-top: 0;
  font-size: 28px;
  color: #b30000; /* dark red title */
}

#question {
  font-size: 20px;
  margin: 20px 0 25px;
  color: #990000; /* deep red */
  font-weight: 600;
}

#choices button {
  padding: 10px 16px;
  margin: 5px;
  border-radius: 12px;
  font-size: 15px;
  border: none;
  cursor: pointer;
  background: #ffd6d6; /* light red background for buttons */
  color: #660000; /* dark red text */
  transition: 0.2s;
}

#choices button:hover {
  background: #ffb3b3;
  transform: translateY(-2px);
}

button.submit-btn {
  width: 100%;
  margin-top: 15px;
  padding: 14px;
  border: none;
  background: #ff1a1a; /* bright red submit button */
  color: white;
  font-size: 17px;
  border-radius: 14px;
  cursor: pointer;
  transition: 0.2s;
}

button.submit-btn:hover {
  background: #cc0000;
  transform: translateY(-2px);
}

.credits {
  margin-top: 18px;
  font-size: 13px;
  color: #4b4b4b;
  opacity: 0.9;
}

a.sheet-link {
  color: #b30000;
  text-decoration: underline;
  font-size: 13px;
}

  </style>
</head>
<body>
  <div class="garlands"></div>
  <div class="layout">
    <div class="left-ad">
      <img id="adImage" src="" alt="Ad image" style="display:none" />
      <div class="christmas-tree">
        <img id="daily-gift" src="gift1.png" width="80" />
      </div>
      <img src="breakdance-santa.gif" class="santa" />
    </div>
    <div class="quiz-card">
      <h1>De Koen Quiz</h1>
      <div id="question">Loading today's question...</div>
      <div id="choices"></div>
      <input id="username" placeholder="Je naam" />
      <textarea id="answer" placeholder="Je antwoord" rows="4"></textarea>
      <button class="submit-btn" onclick="submitAnswer()">Verstuur</button>
    </div>
  </div>

  <!-- Music -->
  <audio id="bgMusic" src="music.mp3" autoplay loop></audio>
  <button onclick="toggleMusic()">Pause / Play Music</button>

  <script>
    let currentQuestionId = null;

    async function loadQuestion() {
      const res = await fetch("/question");
      const data = await res.json();
      currentQuestionId = data.id;
      document.getElementById("question").innerText = data.question || "Geen vraag gevonden.";
      const choicesDiv = document.getElementById("choices");
      choicesDiv.innerHTML = "";
      if (data.choices) {
        data.choices.split(",").forEach(choice => {
          const btn = document.createElement("button");
          btn.innerText = choice.trim();
          btn.onclick = () => document.getElementById("answer").value = choice.trim();
          choicesDiv.appendChild(btn);
        });
      }
    }

    async function loadAd() {
      const res = await fetch("/ad");
      const json = await res.json();
      if (json.image) {
        const ad = document.getElementById("adImage");
        ad.src = json.image;
        ad.style.display = "block";
      }
    }

    async function submitAnswer() {
      const user = document.getElementById("username").value.trim();
      const answer = document.getElementById("answer").value.trim();
      if (!user || !answer || !currentQuestionId) { alert("Vul je naam en antwoord in!"); return; }

      const res = await fetch("/answer", {
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({user_name:user, answer, question_id:currentQuestionId})
      });
      const data = await res.json();
      if(res.ok) { alert("Antwoord verstuurd!"); document.getElementById("answer").value=""; document.getElementById("username").value=""; }
      else alert("Fout bij versturen: "+(data.error||"onbekend"));
    }

    function toggleMusic() {
      const music = document.getElementById("bgMusic");
      if(music.paused) music.play(); else music.pause();
    }

    // Daily gift logic
    const gifts = ["gift1.png","gift2.png","gift3.png","gift4.png"];
    const today = new Date().getDate();
    document.getElementById("daily-gift").src = gifts[(today-1)%gifts.length];

    loadQuestion();
    loadAd();
  </script>
</body>
</html>
